TOPICS = topic1 topic2  # Default topics

main_uncommented.tex: main.tex
	cp main.tex main_uncommented.tex
	for topic in $(TOPICS); do \
	  sed -i "s/% \\\\input{$$topic/main/\\\\input{$$topic/main/" main_uncommented.tex; \
	done

main.pdf: main_uncommented.tex
	pdflatex -output-directory . $<
	mv main.pdf $@

.PHONY: all
all: main.pdf

